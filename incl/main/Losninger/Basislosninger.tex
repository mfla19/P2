\section{Basisløsninger}

%Jeg har endnu ikke fået gennemgået beviserne til de to sætninger ordentligt. de er bare stjålet fra jer andre.

Basisløsninger danner grundlaget for udregningen af den optimale løsning, hvilket beskrives og anvendes i Kapitel \ref{afsnit:simplex}. For at kunne beskrive netop basisløsninger er det nødvendigt først at introducere definitionen for aktive betingelser.%Ved ikke: Skal vi også bruge fed når ord introduceres i bindende tekst?

\begin{defn}[Aktive betingelser]
En betingelse siges at være en \textbf{aktiv betingelse} for en givet løsningsvektor $\vec{x}^*$, hvis det gælder, at\\ $\vec{a}_i^T \vec{x}^* = b_i$.
\label{def:aktiv}
\end{defn}

Generelt bliver aktive betingelser brugt, da de for uligheder repræsenterer en grænse for de mulige løsninger i en given retning, mens de for ligheder blot beskriver, at betingelsen er opfyldt.
Yderligere anvendes skæringen mellem disse aktive betingelser, da den optimale løsning for lineære programmeringsproblemer findes i netop disse skæringer. Hvorfor dette netop er tilfældet bliver begrundet i Afsnit \ref{sec:eksistens}.

\begin{stn}[Lineært uafhængige rækker]
Lad $\vec{x}^* \in \mathds{R}^n$ og $I = \{i | \vec{a_i}^T \vec{x}^* = b_i\}$ være mængden af indekser for aktive betingelser. Da er følgende udsagn ækvivalente:
\begin{enumerate}[label=(\alph*)]
\item Mængden $R_a =\{\vec{a_i}| i\in I\}$ indeholder vektorer, hvoraf $n$ af dem er lineært uafhængige.
\item Spannet $span(R_a) = \mathds{R}^n$.
\item Ligningssystemet $\vec{a_i}^T \vec{x}^* = b_i$, for $i \in I$ har en entydig løsning.
\end{enumerate}
\label{stn:uniklosning}
\end{stn} %Ved ikke: Bør det siges at $\vec{a_i}$ repræcentere en række, eller er det underforstået i rapporten da den altid gør det?

\begin{proof}
	(a) <=> (b): Antag at der i $R_a$ er $n$ lineært uafhængige vektorer. Da der er $n$ lineært uafhængige vektorer må dimensionen af spannet af $R_a$ være $n$. Da $dim(span(R_a))=dim(\mathds{R}^n)=n$ og da $R_a \subseteq \mathds{R}^n$ må det følge af Sætning \ref{stn:dimunderrum} at $span(R_a)=\mathds{R}^n$. Tilsvarende gælder det at hvis $span(R_a)=\mathds{R}^n$, må det gælde at $dim(span(R_a))=dim(\mathds{R}^n)=n$. Da vil kardinaliteten af en basis for $R_a$ nødvendigvis være $n$, hvorved $R_a$ skal indeholde $n$ lineært uafhængige vektorer.


(a) <=> (c): Antag at $span(R_a)=\mathds{R}^n$. Antag nu for modstrid, at der findes to løsninger, $\vec{x}_a$ og $\vec{x}_b$, som opfylder $\vec{a}_i\vec{x}=\vec{b}$ for alle $i \in I$. 
Da vil det for alle $i \in I$ gælde at $\vec{a}_i^T\vec{x}_a=\vec{b}$ og at $\vec{a}_i^T\vec{x}_b=\vec{b}$, hvorved $\vec{a}_i^T\vec{d}=\vec{0}$, hvor $\vec{d}=\vec{x}_a-\vec{x}_b$. 
Vektoren $\vec{d}$ vil da være orthogonal på alle $\vec{a}_i$ for $i \in I$ og kan derfor ikke være en lineær kombination af disse. Herved kan $R_a$ ikke udspænde hele $\mathds{R}^n$, da $\vec{d} \in \mathds{R}^n$ men $\vec{d} \notin span(R_a)$.
Tilsvarende antages det nu at der kun er en unik løsning til ligningssystemet. For modstrid antages det at $R_a$ ikke udspænder hele $\mathds{R}^n$ Der kan derved vælges en vektor $\vec{d}$ som er orthogonal til $span(R_a)$ hvorved $\vec{a}_i^T(\vec{x}+\vec{d})=\vec{b}$. Derved er $\vec{x}$ ikke en unik løsning og der er opstået modstrid.
\end{proof}
	
Nu hvor aktive betingelser og lineært uafhængige rækker er definere, kan basisløsninger definere og beskrives

\begin{defn}[Basisløsning og mulig basisløsning]
Lad $P$ være et polyeder dannet af lineære bibetingelser, og lad $\vec{x}^*\in \mathds{R}^n$. Da er $\vec{x}^*$ en \textbf{basisløsning}, hvis
\begin{enumerate}[label=(\alph*)]
\item Alle lighedskrav er aktive
\item Af de aktive betingelser er $n$ lineært uafhængige
\end{enumerate}
og en \textbf{mulig basisløsning}, hvis
\begin{enumerate}[label=(\alph*)]
\setcounter{enumi}{2}
\item hvis $\vec{x}^* \in P$ er en basisløsning.
\end{enumerate}
\label{def:basislosning}
\end{defn}
Det vil sige at en basisløsning ikke nødvendigvis ligger ikke i løsningsmængden, da skæringen mellem de $n$ lineært uafhængige krav ikke pr. Definition \ref{def:basislosning} behøver at ligge i løsningsmængden, og en mulig basisløsning er dermed det særtilfælde af basisløsninger som tilhører løsnings mængden.
En konsekvens af at en basisløsning altid skal have $n$ lineært uafhængige aktive betingelser er, i følge Sætning \ref{stn:uniklosning}, er at basisløsningen er en entydig løsning til ledningssystemet af de $n$ aktive bibetingelser.
%der skal måske lige laves en merge her
%Enhver bibetingelse udspænder et rum, for hvilket betingelsen er opfyldt. Skæringen, af de aktive betingelser, danner derved et rum, som er fællesmængden af betingelsernes udspændte rum. Skæringen, af en mængde af aktive betingelser, svarer derved til den mulige mængde af disse betingelser. Dog gælder det for basisløsninger pr. Definition \ref{def:basislosning}, at der for en basisløsning $\vec{x}$ skal være $n$ lineært uafhængige aktive betingelser, hvorved en basisløsningen er en unik vektor, hvilket er bevist igennem Sætning \ref{stn:uniklosning}. %Ved ikke, er en vektor og et punkt det samme?

\begin{kor}[Endelig mængde af basisløsninger]
Givet en endelig mængde af bibetingelser, vil der kun eksistere en endelig mængde af basisløsninger og derved også kun en endelig mængde mulige basisløsninger.
\label{kor:endeligbasis}
\end{kor}

\begin{proof}
Betragt et lineært ligningssystem med $m$ uligheder og løsningsvektorer på formen $\vec{x} \in \mathds{R}^n$, hvor m er et endeligt tal.
	Betragt da systemet af $n$ aktive uafhængige lineære uligheder udvalgt af de $m$ uligheder. Da vil dette system ifølge Sætning \ref{stn:uniklosning} kun have en løsning, og denne udvælgelse af uligheder giver derved kun en basisløsning. Da der kun er en endelig mængde af muligheder for at udtrække $n$ af $m$ uligheder på, vil der netop også kun være en endelig mængde af basisløsninger. Da mængden af mulige basisløsninger er en delmængde af mængden af basisløsninger, vil der også kun være en endelig mængde af mulige basisløsninger.
\end{proof}

Det at en basisløsning er en entydig løsning til ligningssystemet af dens $n$ lineært uafhængige bibetingelser kan bruges til at finde en procedure til at finde basisløsninger.

\begin{stn}[Krav til basisløsninger]
Lad $A\vec{x}=\vec{b}$ og $\vec{x}\geq 0$, hvor $A$ er en $m\times n$ matrix med lineært uafhængige rækker. Da er $\vec{x}^*\in \mathds{R}^n$ en basisløsning hvis og kun hvis $A\vec{x}^*=b, \vec{x}^* \geq 0$, og der eksisterer indekser $B(1), ..., B(m)$ således, at
\begin{enumerate}[label=(\alph*)]
\item Kolonerne $A_{B(1)}, ..., A_{B(m)}$ er lineært uafhængige og
\item $x_j = 0$, hvis $j \neq B(1),...,B(m)$.
\end{enumerate}
\label{stn:kravtilbasis}
\end{stn}

\begin{proof}
Først vises at (a) og (b) medfører at $\vec{x}$ er en basisløsning.
Lad $I_m$ være mængden af indeks for de lineært uafhængige søjler  $I_m=\{B(1),\dots,B(m)\}$. Per definition er $\vec{b}=\sum_{j=1}^{n} x_j \vec{A}_j$, hvilket må være det samme som $\vec{b}=\sum_{j\in I_m} x_j \vec{A}_j+\sum_{j\notin I_m} x_j \vec{A}_j$, hvor summeringen er opdelt efter om kolonnerne har indeks $i \in I_m$. 
Ifølge sætningens punkt (b) er $x_j=0$ for $j \notin I_m$. Derved bliver summeringen forkortet til $\vec{b}=\sum_{j\in I}x_j \vec{A}_j$. Da vektorerne $\vec{A}_j$ for $j \in I_m$ er lineært uafhængige vil ligningssystemet nødvendigvis have en unik løsning. Da ligningssystemet har en unik løsning gælder det af Sætning \ref{stn:uniklosning}, at ligningssystemet har $n$ lineært uafhængige rækker, som alle er aktive. Da der er $n$ aktive betingelser og da alle lighedskrav er aktive, vil det pr. Definition \ref{def:basislosning} sige at $\vec{x}$ er en basisløsning.

% som er summen af alle de lineære uafhængige rækker og deres løsninger lagt sammen med summen af de lineære afhængige rækker og deres løsninger, men $\vec{x_j}$ til de lineære uafhængige løsninger er er i følge sætningen $x_i = 0$ hvis $i \neq B(1),...,B(m)$ så derfor må ligningen blive $b=\sum_{j\in I_m}^{n}x_j \vec{A}_j+0$,
% 
%så derfor må $\vec{x}$ være en basis løsning.

Herefter vises at det at $\vec{x}$ er en basisløsning medfører (a) og (b). Antag at $\vec{x}$ er en basisløsning og lad $x_j$ for indekser $j \in I_k=\{B(1),\dots B(k)\}$ være alle ikke-nul komponenter af $\vec{x}$.
Eftersom $\vec{x}$ er en basisløsning, så må ligningssystemet af aktive betingelser $\sum_{j=1}^{n}\vec{A}_jx_j=\vec{b}$, hvor $x_j=0$ for $j\notin I_k$ have en unik løsning. Dette gælder da en basisløsning har $n$ lineært uafhængige aktive betingelser, hvilket ifølge Sætning \ref{stn:uniklosning} medfører at systemet har en unik løsning. 
Ligeledes må ligningen $\sum_{j \in I_k}\vec{A}_jx_j=\vec{b}$ have en unik løsning og derfor må kolonerne $\vec{A}_{B(1)}, ..., \vec{A}_{B(k)}$ være lineært uafhængige. Derfor må det gælde at $k \leq m$. % Hvis ikke dette var tilfældet ville der eksistere flere $\vec{x}$ som opfylder ligningssystemet, hvilket modstrider at der er en unik løsning.\\
%Eftersom kolonerne $\vec{A}_{B(1)}, ..., \vec{A}_{B(k)}$ er lineært uafhængige, så må det gælde at $k\leq m$. 
Da $A$ har $m$ lineært uafhængige rækker, må $A$ også have $m$ lineært uafhængige kolonner, hvorved $Col(A)=\mathds{R}^m$.

Den næste del af beviset viser, at der for enhver udvælgelse af indekser $I_k$ findes indekser $I_m$ således at $I_k \subseteq I_m$. 
%Den næste del af beviset viser, at der for enhver udvælgelse af $k$ lineært uafhængige kolonner med indekser $I_k$, gælder at der findes en mængde af $m$ lineært uafhængige kolonner med indekser $I_m$, hvorom det gælder at $I_k \subseteq I_m$.
Altså findes der indekser $B(k+1),...,B(m)$, således at kolonnerne med indekser $B(1),...,B(k),...,B(m)$ er lineært uafhængige. 

Hvis alle $\vec{A}_j$ for $j \notin I_k$ er lineært afhængige af $\vec{A}_j$ for $j \in I_k$, gælder det at $span\left( \vec{A}_{B(1)},...,\vec{A}_{B(k)} \right)=Col(A)=\mathds{R}^m$, hvorved $k=m$. 
Hvis der i stedet eksisterer en kolonne med indeks $j \notin I_k$ som er lineært uafhængig af disse kolonner, kan denne tilføjes til mængden af nu $k+1$ uafhængige vektorer. Denne proces kan gentages $m-k$ gange. Da $i \notin I_m$ medfører at $i \notin I_k$ gælder det derved at $\vec{x}_i =0$ for $i \notin I_m$
\end{proof}

\begin{pro}{Procedure for konstruktion af basisløsninger}
Vælg $m$ lineært uafhængige koloner $\vec{A}_{B(1)},\dots,\vec{A}_{B(m)}$
Lad $x_i=0 \,\forall i\neq B(1),\dots,B(m)$
Løs $A\vec{x}=\vec{b}$ for de ubekendte $x_{B(1)},\dots x_{B(m)}$
\end{pro}
Bemærk at proceduren indirekte kan bruges til at finde mulige basisløsninger, da de er et særtilfælde af basisløsninger.\\
%En Basis løsning lavet med denne procedure, så længde den ikke er negativ, kaldes den for en mulig basisløsning. Og fordi en mulig basisløsning er en basisløsning, så kan en mulig basisløsning findes, ved at lave basisløsninger.\\

Hvis $\vec{x}$ er en basisløsning, kaldes indgangene $x_{B(1)},\dots ,x_{B(m)}$ for basis variable, mens $x_i \,\forall i\neq B(1),\dots,B(m)$ kaldes for ikke-basis variabler. Mens søjlerne $\vec{A}_{B(1)},\dots,\vec{A}_{B(m)}$ udgør en basis for $\mathds{R}^m$ ifølge Sætning \ref{stn:uniklosning}.
\begin{defn}
Lad $\vec{x}$ en basisløsning så $x_i = 0$ for alle $i \notin I_B$, da er $B = [\vec{A_i}: i \in I_B]$ \textbf{basismatricen} knyttet til basisløsningen. 
Og ved $\vec{x}_B$ forstås løsningen til ligningsstemmet $B\vec{x}_B =\vec{b}$.
\end{defn}
Bemærk at da $B$ består af $m$ lineært uahængige rækker og er en $m\times m$ matrix følger det af Sætning \ref{stn:inversmatrix}, at $B^{-1}$ eksistere. 


%\\ %måske et andet ord
%Søjlerne $A_{B(1)},\dots ,A_{B(m)}$ kaldes for basis søjlerne og da de er lineært uafhængige, så danne de en basis for $\mathds{R}^m$\\
%To baser kan være forskellige, men de vil blive betragtet som værende to forskellige mængder $\{B(1),\dots,B(m)\}$ af basis indekser, hvis disse to mængde består af de samme basis indekser, så vil de blive betragtet som værende samme basis.\\
%Hvis søjlerne $\vec{A}_{B(1)},\dots,\vec{A}_{B(m)}$, bliver sat ved siden af hinanden, så der dannes $m\times m$ matrixen $B$, som kaldes en basis matrix. ligeledes dannes vektoren $\vec{x}_{B}$ bestående af basis variablerne. Basis variablerne er bestemt ved at løse ligningen $B\vec{x}_B=\vec{b}$ således at en unik løsning er givet ved $\vec{x}_B=B^{-1}\vec{b}$
%\begin{defn}
%Betragt en $m\times m$ basis matrix $B$ dannet af lineært uafhængige søjler fra $A$ i $A\vec{x}=\vec{b}$
%
%\end{defn}

\begin{comment}
Der mangler bare generelt bindetekst mellem sætninger, fra at korollar 6.12 skal introduceres til at kapitlet skal afsluttes og føres videre til naboløsninger
\end{comment}




